<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>ระบบวิเคราะห์รูเล็ตขั้นสูง</title>
  <style>
    body {
      background: #076b34;
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
    }
    h1, h2 {
      color: gold;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
      margin-bottom: 20px;
      text-align: center;
    }
    .roulette-container {
      display: flex;
      background: #076b34;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.7);
      gap: 5px;
    }
    .zero-section {
      display: flex;
      flex-direction: column;
      margin-right: 5px;
    }
    .zero {
      background: #008000;
      color: white;
      font-weight: bold;
      font-size: 24px;
      width: 50px;
      height: 150px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #ddd;
      border-radius: 5px;
      margin-bottom: 5px;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
      cursor: pointer;
    }
    .main-table {
      display: grid;
      grid-template-rows: repeat(3, 50px) 60px;
      grid-template-columns: repeat(12, 50px);
      gap: 2px;
    }
    .number-cell {
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 18px;
      color: white;
      border: 1px solid #444;
      border-radius: 3px;
      cursor: pointer;
      transition: all 0.2s;
      user-select: none;
    }
    .red {
      background: #d00;
      border-color: #f44;
    }
    .black {
      background: #111;
      border-color: #444;
    }
    .number-cell:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px rgba(255,255,255,0.6);
    }
    .dozen-cell {
      background: #076b34;
      color: white;
      font-size: 16px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid #0a8a4a;
      border-radius: 3px;
      cursor: pointer;
      grid-row: 4;
      user-select: none;
    }
    .first-dozen,
    .second-dozen,
    .third-dozen {
      background: #076b34;
      color: white;
      font-size: 16px;
      font-weight: bold;
      border: 1px solid #0a8a4a;
      border-radius: 3px;
      cursor: pointer;
      user-select: none;
    }
    .first-dozen {
      grid-column: 1 / span 4;
    }
    .second-dozen {
      grid-column: 5 / span 4;
    }
    .third-dozen {
      grid-column: 9 / span 4;
    }
    .column-section {
      display: grid;
      grid-template-rows: repeat(3, 50px) 60px;
      grid-template-columns: 60px;
      gap: 2px;
      margin-left: 5px;
    }
    .column-cell {
      background: #076b34;
      color: white;
      font-size: 16px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid #0a8a4a;
      border-radius: 3px;
      writing-mode: vertical-rl;
      transform: rotate(180deg);
      cursor: pointer;
      user-select: none;
    }
    .column-cell:hover {
      background: #0a8a4a;
    }
    .roadmap-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }
    .roadmap-buttons {
      display: flex;
      gap: 10px;
    }
    .roadmap-buttons button {
      background: #0a8a4a;
      color: white;
      border: none;
      padding: 8px 15px;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .roadmap-buttons button:hover {
      background: #076b34;
    }
    .roadmap-container {
      width: 620px;
      background: #222;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.7);
      display: grid;
      grid-template-columns: repeat(12, 50px);
      grid-template-rows: repeat(6, 50px);
      gap: 2px;
    }
    .roadmap-cell {
      width: 50px;
      height: 50px;
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 18px;
      color: white;
      background: #444;
      user-select: none;
    }
    .roadmap-cell.red {
      background: #d00;
    }
    .roadmap-cell.black {
      background: #111;
    }
    .roadmap-cell.green {
      background: #008000;
    }
    .prediction-section {
      width: 90%;
      max-width: 1200px;
      display: flex;
      justify-content: space-between;
      gap: 20px;
      flex-wrap: wrap;
    }
    .prediction-box {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 10px;
      padding: 15px;
      width: 22%;
      border: 2px solid gold;
    }
    .prediction-title {
      color: gold;
      font-size: 20px;
      text-align: center;
      margin-bottom: 15px;
      font-weight: bold;
      border-bottom: 1px solid gold;
      padding-bottom: 5px;
    }
    .prediction {
      color: white;
      font-size: 18px;
      margin-top: 10px;
    }
    .last-prediction {
      color: gold;
      font-size: 14px;
      margin-top: 10px;
      padding: 5px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 5px;
    }
    .result-history {
      color: white;
      font-size: 18px;
      margin-top: 15px;
      letter-spacing: 3px;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    .result-count {
      color: white;
      font-size: 14px;
      margin-top: 10px;
      background: rgba(0, 0, 0, 0.3);
      padding: 5px;
      border-radius: 5px;
    }
    .num-info {
      color: yellow;
      font-size: 12px;
      margin-top: 5px;
    }
    .percentage {
      color: cyan;
      font-weight: bold;
      font-size: 16px;
    }
    .recommendation {
      margin-top: 20px;
      padding: 10px;
      background: rgba(255, 215, 0, 0.2);
      border: 1px solid gold;
      border-radius: 5px;
      text-align: center;
    }
    .recommendation-title {
      color: gold;
      font-weight: bold;
      margin-bottom: 5px;
    }
    .recommendation-content {
      color: white;
      font-size: 16px;
    }
    .best-choice {
      color: lime;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>ระบบวิเคราะห์รูเล็ตขั้นสูง</h1>
  <h2>(โหล + คอลัมน์ + โร้ดแม็บ)</h2>

  <!-- ตารางรูเล็ต -->
  <div class="roulette-container">
    <div class="zero-section">
      <div class="zero" id="zero-cell">0</div>
    </div>
    <div class="main-table" id="roulette-table"></div>
    <div class="column-section">
      <div class="column-cell">2 to 1</div>
      <div class="column-cell">2 to 1</div>
      <div class="column-cell">2 to 1</div>
      <div class="column-cell"></div>
    </div>
  </div>

  <!-- โร้ดแม็บ -->
  <div class="roadmap-wrapper">
    <div class="roadmap-buttons">
      <button id="undo-btn">ลบตัวล่าสุด</button>
      <button id="clear-btn">ลบทั้งหมด</button>
    </div>
    <div class="roadmap-container" id="roadmap"></div>
  </div>

  <!-- ผลทาย -->
  <div class="prediction-section">
    <!-- โหล แทง โหล -->
    <div class="prediction-box">
      <div class="prediction-title">โหล แทง โหล <span id="percentage1" class="percentage">(0%)</span></div>
      <div id="prediction" class="prediction">ผลทาย: -</div>
      <div id="last-prediction" class="last-prediction"></div>
      <div id="result-history" class="result-history">ผลการทาย: </div>
      <div id="result-count" class="result-count"></div>
      <div id="num-info-dozen" class="num-info"></div>
    </div>
    <!-- โหล แทง แถว -->
    <div class="prediction-box">
      <div class="prediction-title">โหล แทง แถว <span id="percentage2" class="percentage">(0%)</span></div>
      <div id="prediction2" class="prediction">ผลทาย: -</div>
      <div id="last-prediction2" class="last-prediction"></div>
      <div id="result-history2" class="result-history">ผลการทาย: </div>
      <div id="result-count2" class="result-count"></div>
      <div id="num-info-column" class="num-info"></div>
    </div>
    <!-- แถว แทง แถว -->
    <div class="prediction-box">
      <div class="prediction-title">แถว แทง แถว <span id="percentage3" class="percentage">(0%)</span></div>
      <div id="prediction3" class="prediction">ผลทาย: -</div>
      <div id="last-prediction3" class="last-prediction"></div>
      <div id="result-history3" class="result-history">ผลการทาย: </div>
      <div id="result-count3" class="result-count"></div>
      <div id="num-info-column3" class="num-info"></div>
    </div>
    <!-- แถว แทง โหล -->
    <div class="prediction-box">
      <div class="prediction-title">แถว แทง โหล <span id="percentage4" class="percentage">(0%)</span></div>
      <div id="prediction4" class="prediction">ผลทาย: -</div>
      <div id="last-prediction4" class="last-prediction"></div>
      <div id="result-history4" class="result-history">ผลการทาย: </div>
      <div id="result-count4" class="result-count"></div>
      <div id="num-info-dozen4" class="num-info"></div>
    </div>
  </div>

  <!-- คำแนะนำการเล่น -->
  <div class="recommendation">
    <div class="recommendation-title">คำแนะนำการเล่นในรอบนี้</div>
    <div id="recommendation-content" class="recommendation-content">
      กรุณากรอกข้อมูลผลลัพธ์อย่างน้อย 3 ครั้งเพื่อให้ระบบวิเคราะห์รูปแบบ
    </div>
  </div>

  <script>
    const table = document.getElementById('roulette-table');
    const roadmap = document.getElementById('roadmap');
    const undoBtn = document.getElementById('undo-btn');
    const clearBtn = document.getElementById('clear-btn');

    // ผลทาย
    const predictionDiv = document.getElementById('prediction');
    const prediction2Div = document.getElementById('prediction2');
    const prediction3Div = document.getElementById('prediction3');
    const prediction4Div = document.getElementById('prediction4');
    const lastPredictionDiv = document.getElementById('last-prediction');
    const lastPrediction2Div = document.getElementById('last-prediction2');
    const lastPrediction3Div = document.getElementById('last-prediction3');
    const lastPrediction4Div = document.getElementById('last-prediction4');
    const resultHistoryDiv = document.getElementById('result-history');
    const resultHistory2Div = document.getElementById('result-history2');
    const resultHistory3Div = document.getElementById('result-history3');
    const resultHistory4Div = document.getElementById('result-history4');
    const resultCountDiv = document.getElementById('result-count');
    const resultCount2Div = document.getElementById('result-count2');
    const resultCount3Div = document.getElementById('result-count3');
    const resultCount4Div = document.getElementById('result-count4');
    const numInfoDozen = document.getElementById('num-info-dozen');
    const numInfoColumn = document.getElementById('num-info-column');
    const numInfoColumn3 = document.getElementById('num-info-column3');
    const numInfoDozen4 = document.getElementById('num-info-dozen4');
    const percentage1Div = document.getElementById('percentage1');
    const percentage2Div = document.getElementById('percentage2');
    const percentage3Div = document.getElementById('percentage3');
    const percentage4Div = document.getElementById('percentage4');
    const recommendationContent = document.getElementById('recommendation-content');

    // ตัวเลขแดง
    const redNumbers = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
    const numbers = [
      3, 6, 9, 12, 15, 18, 21, 24, 27, 30, 33, 36,
      2, 5, 8, 11, 14, 17, 20, 23, 26, 29, 32, 35,
      1, 4, 7, 10, 13, 16, 19, 22, 25, 28, 31, 34
    ];

    // ตัวแปรนับผลทาย
    let correctCount = 0;
    let incorrectCount = 0;
    let lastExpectedDozens = [];
    let lastPredictionText = "";

    let correctCount2 = 0;
    let incorrectCount2 = 0;
    let lastExpectedColumns = [];
    let lastPredictionText2 = "";

    let correctCount3 = 0;
    let incorrectCount3 = 0;
    let lastExpectedColumns3 = [];
    let lastPredictionText3 = "";

    let correctCount4 = 0;
    let incorrectCount4 = 0;
    let lastExpectedDozens4 = [];
    let lastPredictionText4 = "";

    // สร้างตารางรูเล็ต
    numbers.forEach((num, index) => {
      const cell = document.createElement('div');
      cell.className = `number-cell ${redNumbers.includes(num) ? 'red' : 'black'}`;
      cell.textContent = num;
      const col = (index % 12) + 1;
      const row = Math.floor(index / 12) + 1;
      cell.style.gridColumn = col;
      cell.style.gridRow = row;
      cell.addEventListener('click', () => addToRoadmap(num));
      table.appendChild(cell);
    });

    // สร้าง 0
    const zeroCell = document.getElementById('zero-cell');
    zeroCell.addEventListener('click', () => addToRoadmap(0));

    // สร้างโหลล่าง
    const dozenLabels = ['1st 12', '2nd 12', '3rd 12'];
    dozenLabels.forEach((label, index) => {
      const dozen = document.createElement('div');
      dozen.className = 'dozen-cell';
      dozen.textContent = label;
      if (index === 0) dozen.classList.add('first-dozen');
      else if (index === 1) dozen.classList.add('second-dozen');
      else dozen.classList.add('third-dozen');
      dozen.addEventListener('click', () => console.log('เลือกโหล:', label));
      table.appendChild(dozen);
    });

    // โร้ดแม็บ
    const roadmapRows = 6;
    const roadmapCols = 12;
    const roadmapData = Array.from({length: roadmapRows}, () => Array(roadmapCols).fill(null));
    let currentCol = 0;
    let currentRow = 0;
    const history = [];

    for (let r = 0; r < roadmapRows; r++) {
      for (let c = 0; c < roadmapCols; c++) {
        const cell = document.createElement('div');
        cell.className = 'roadmap-cell';
        cell.dataset.row = r;
        cell.dataset.col = c;
        roadmap.appendChild(cell);
      }
    }

    function getDozen(num) {
      if (num >= 1 && num <= 12) return 1;
      else if (num >= 13 && num <= 24) return 2;
      else if (num >= 25 && num <= 36) return 3;
      else return 0;
    }

    function getColumn(num) {
      if (num === 0) return 0;
      return ((num - 1) % 3) + 1;
    }

    function formatResultHistory(marks) {
      let formatted = "";
      for (let i = 0; i < marks.length; i++) {
        if (i > 0 && i % 6 === 0) {
          formatted += "\n";
        }
        formatted += marks[i];
      }
      return formatted;
    }

    function updatePercentages() {
      const total = correctCount + incorrectCount + correctCount2 + incorrectCount2 +
                    correctCount3 + incorrectCount3 + correctCount4 + incorrectCount4;

      if (total === 0) return [0, 0, 0, 0];

      // คำนวณ %
      let basePercentage1 = (correctCount / total) * 100;
      let basePercentage2 = (correctCount2 / total) * 100;
      let basePercentage3 = (correctCount3 / total) * 100;
      let basePercentage4 = (correctCount4 / total) * 100;

      // เพิ่มน้ำหนักสุ่มเล็กน้อย
      function addRandomWeight(base) {
        const offset = (Math.random() - 0.5) * 1;
        return Math.max(0, base + offset);
      }

      basePercentage1 = addRandomWeight(basePercentage1);
      basePercentage2 = addRandomWeight(basePercentage2);
      basePercentage3 = addRandomWeight(basePercentage3);
      basePercentage4 = addRandomWeight(basePercentage4);

      const totalWithOffset = basePercentage1 + basePercentage2 + basePercentage3 + basePercentage4;

      const percentage1 = Math.round((basePercentage1 / totalWithOffset) * 100);
      const percentage2 = Math.round((basePercentage2 / totalWithOffset) * 100);
      const percentage3 = Math.round((basePercentage3 / totalWithOffset) * 100);
      const percentage4 = 100 - (percentage1 + percentage2 + percentage3); // เศษ

      // อัพเดท UI
      percentage1Div.textContent = `(${percentage1}%)`;
      percentage2Div.textContent = `(${percentage2}%)`;
      percentage3Div.textContent = `(${percentage3}%)`;
      percentage4Div.textContent = `(${percentage4}%)`;

      return [percentage1, percentage2, percentage3, percentage4];
    }

    function predictNext() {
      if (history.length < 3) {
        return { 
          dozens: [], columns: [], columns3: [], dozens4: [],
          predictionText: "ไม่มีทาย",
          predictionText2: "ไม่มีทาย",
          predictionText3: "ไม่มีทาย",
          predictionText4: "ไม่มีทาย",
          recommendation: "กรุณากรอกข้อมูลผลลัพธ์อย่างน้อย 3 ครั้ง"
        };
      }

      let lastEntry = history[history.length - 1];
      let lastVal = roadmapData[lastEntry.row][lastEntry.col];
      let lastDozen = getDozen(lastVal);
      let lastColumn = getColumn(lastVal);

      let predictionText = "ไม่มีทาย (0)";
      let predictionText2 = "ไม่มีทาย (0)";
      let predictionText3 = "ไม่มีทาย (0)";
      let predictionText4 = "ไม่มีทาย (0)";

      let expectedDozens = [];
      let expectedColumns = [];
      let expectedColumns3 = [];
      let expectedDozens4 = [];

      // โหล แทง โหล
      if (lastVal === 0) {
        predictionText = "ไม่มีทาย (0)";
      } else if (lastDozen === 1) {
        predictionText = "เล่น: 1-2";
        expectedDozens = [1, 2];
      } else if (lastDozen === 3) {
        predictionText = "เล่น: 2-3";
        expectedDozens = [2, 3];
      } else if (lastDozen === 2) {
        let previousDozen = null;
        for (let i = history.length - 2; i >= 0; i--) {
          const val = roadmapData[history[i].row][history[i].col];
          const d = getDozen(val);
          if (d !== 2 && d !== 0) {
            previousDozen = d;
            break;
          }
        }
        if (previousDozen === 1) {
          predictionText = "เล่น: 1-2";
          expectedDozens = [1, 2];
        } else if (previousDozen === 3) {
          predictionText = "เล่น: 2-3";
          expectedDozens = [2, 3];
        } else {
          predictionText = "เล่น: 2";
          expectedDozens = [2];
        }
      }

      // โหล แทง แถว
      if (lastDozen === 1) {
        predictionText2 = "เล่น: 1-2";
        expectedColumns = [1, 2];
      } else if (lastDozen === 3) {
        predictionText2 = "เล่น: 2-3";
        expectedColumns = [2, 3];
      } else if (lastDozen === 2) {
        let previousDozen = null;
        for (let i = history.length - 2; i >= 0; i--) {
          const val = roadmapData[history[i].row][history[i].col];
          const d = getDozen(val);
          if (d !== 2 && d !== 0) {
            previousDozen = d;
            break;
          }
        }
        if (previousDozen === 1) {
          predictionText2 = "เล่น: 1-2";
          expectedColumns = [1, 2];
        } else if (previousDozen === 3) {
          predictionText2 = "เล่น: 2-3";
          expectedColumns = [2, 3];
        } else {
          predictionText2 = "เล่น: 2";
          expectedColumns = [2];
        }
      }

      // แถว แทง แถว
      if (lastColumn === 1) {
        predictionText3 = "เล่น: 1-2";
        expectedColumns3 = [1, 2];
      } else if (lastColumn === 3) {
        predictionText3 = "เล่น: 2-3";
        expectedColumns3 = [2, 3];
      } else if (lastColumn === 2) {
        let previousColumn = null;
        for (let i = history.length - 2; i >= 0; i--) {
          const val = roadmapData[history[i].row][history[i].col];
          const c = getColumn(val);
          if (c !== 2 && c !== 0) {
            previousColumn = c;
            break;
          }
        }
        if (previousColumn === 1) {
          predictionText3 = "เล่น: 1-2";
          expectedColumns3 = [1, 2];
        } else if (previousColumn === 3) {
          predictionText3 = "เล่น: 2-3";
          expectedColumns3 = [2, 3];
        } else {
          predictionText3 = "เล่น: 2";
          expectedColumns3 = [2];
        }
      }

      // แถว แทง โหล
      if (lastColumn === 1) {
        predictionText4 = "เล่นโหล: 1-2";
        expectedDozens4 = [1, 2];
      } else if (lastColumn === 3) {
        predictionText4 = "เล่นโหล: 2-3";
        expectedDozens4 = [2, 3];
      } else if (lastColumn === 2) {
        let previousColumn = null;
        for (let i = history.length - 2; i >= 0; i--) {
          const val = roadmapData[history[i].row][history[i].col];
          const c = getColumn(val);
          if (c !== 2 && c !== 0) {
            previousColumn = c;
            break;
          }
        }
        if (previousColumn === 1) {
          predictionText4 = "เล่นโหล: 1-2";
          expectedDozens4 = [1, 2];
        } else if (previousColumn === 3) {
          predictionText4 = "เล่นโหล: 2-3";
          expectedDozens4 = [2, 3];
        } else {
          predictionText4 = "เล่นโหล: 2";
          expectedDozens4 = [2];
        }
      }

      const percentages = updatePercentages();

      const predictions = [
        { type: 'โหล แทง โหล', text: predictionText, percentage: percentages[0] },
        { type: 'โหล แทง แถว', text: predictionText2, percentage: percentages[1] },
        { type: 'แถว แทง แถว', text: predictionText3, percentage: percentages[2] },
        { type: 'แถว แทง โหล', text: predictionText4, percentage: percentages[3] }
      ];

      // เรียงลำดับตามเปอร์เซ็นต์ความแม่นยำ
      predictions.sort((a, b) => b.percentage - a.percentage);

      // เลือกคำแนะนำที่เปอร์เซ็นต์รองลงมา (อันดับที่ 2)
      let recommendedPrediction = null;
      if (predictions.length >= 2) {
        // หาตัวเลือกแรกที่สามารถทำนายได้ (ไม่ใช่ "ไม่มีทาย")
        for (let i = 1; i < predictions.length; i++) {
          if (predictions[i].text !== "ไม่มีทาย") {
            recommendedPrediction = predictions[i];
            break;
          }
        }
        // ถ้าไม่พบ (กรณีที่ตัวเลือกที่ 2 เป็น "ไม่มีทาย") ให้เลือกตัวเลือกแรกที่ทำนายได้
        if (!recommendedPrediction) {
          for (let i = 0; i < predictions.length; i++) {
            if (predictions[i].text !== "ไม่มีทาย") {
              recommendedPrediction = predictions[i];
              break;
            }
          }
        }
      }

      let recommendation = "ไม่มีข้อมูลพอสำหรับคำแนะนำ";

      if (recommendedPrediction && recommendedPrediction.text !== "ไม่มีทาย") {
        recommendation = `${recommendedPrediction.text} (${recommendedPrediction.type})`;
      } else if (predictions.length > 0 && predictions[0].text !== "ไม่มีทาย") {
        // ถ้าไม่พบตัวเลือกรอง ให้ใช้ตัวเลือกแรก
        recommendation = `${predictions[0].text} (${predictions[0].type})`;
      }

      return {
        dozens: expectedDozens,
        columns: expectedColumns,
        columns3: expectedColumns3,
        dozens4: expectedDozens4,
        predictionText: predictionText,
        predictionText2: predictionText2,
        predictionText3: predictionText3,
        predictionText4: predictionText4,
        recommendation: recommendation
      };
    }

    function checkPredictions(num) {
      const actualDozen = getDozen(num);
      const actualColumn = getColumn(num);

      numInfoDozen.textContent = `เลขที่ออก: ${num} (โหล ${actualDozen || 'ศูนย์'})`;
      numInfoColumn.textContent = `เลขที่ออก: ${num} (แถว ${actualColumn || 'ศูนย์'})`;
      numInfoColumn3.textContent = `เลขที่ออก: ${num} (แถว ${actualColumn || 'ศูนย์'})`;
      numInfoDozen4.textContent = `เลขที่ออก: ${num} (โหล ${actualDozen || 'ศูนย์'})`;

      // เช็คผลทาย 1 (โหล แทง โหล)
      if (lastExpectedDozens.length > 0) {
        const dozenMark = lastExpectedDozens.includes(actualDozen) ? '✅' : '❌';
        const currentMarks = resultHistoryDiv.innerHTML.replace("ผลการทาย: ", "").replace(/\n/g, "");
        const newMarks = currentMarks + dozenMark;
        resultHistoryDiv.innerHTML = "ผลการทาย: " + formatResultHistory(newMarks);
        if (dozenMark === '✅') correctCount++;
        else incorrectCount++;
        resultCountDiv.textContent = `ถูก: ${correctCount} | ผิด: ${incorrectCount}`;
        lastPredictionDiv.textContent = `ทายครั้งล่าสุด: ${lastPredictionText} | ออก: ${num} (โหล ${actualDozen || 'ศูนย์'}) - ${dozenMark === '✅' ? 'ถูก' : 'ผิด'}`;
      }

      // เช็คผลทาย 2 (โหล แทง แถว)
      if (lastExpectedColumns.length > 0) {
        const columnMark = lastExpectedColumns.includes(actualColumn) ? '✅' : '❌';
        const currentMarks = resultHistory2Div.innerHTML.replace("ผลการทาย: ", "").replace(/\n/g, "");
        const newMarks = currentMarks + columnMark;
        resultHistory2Div.innerHTML = "ผลการทาย: " + formatResultHistory(newMarks);
        if (columnMark === '✅') correctCount2++;
        else incorrectCount2++;
        resultCount2Div.textContent = `ถูก: ${correctCount2} | ผิด: ${incorrectCount2}`;
        lastPrediction2Div.textContent = `ทายครั้งล่าสุด: ${lastPredictionText2} | ออก: ${num} (แถว ${actualColumn || 'ศูนย์'}) - ${columnMark === '✅' ? 'ถูก' : 'ผิด'}`;
      }

      // เช็คผลทาย 3 (แถว แทง แถว)
      if (lastExpectedColumns3.length > 0) {
        const columnMark = lastExpectedColumns3.includes(actualColumn) ? '✅' : '❌';
        const currentMarks = resultHistory3Div.innerHTML.replace("ผลการทาย: ", "").replace(/\n/g, "");
        const newMarks = currentMarks + columnMark;
        resultHistory3Div.innerHTML = "ผลการทาย: " + formatResultHistory(newMarks);
        if (columnMark === '✅') correctCount3++;
        else incorrectCount3++;
        resultCount3Div.textContent = `ถูก: ${correctCount3} | ผิด: ${incorrectCount3}`;
        lastPrediction3Div.textContent = `ทายครั้งล่าสุด: ${lastPredictionText3} | ออก: ${num} (แถว ${actualColumn || 'ศูนย์'}) - ${columnMark === '✅' ? 'ถูก' : 'ผิด'}`;
      }

      // เช็คผลทาย 4 (แถว แทง โหล)
      if (lastExpectedDozens4.length > 0) {
        const dozenMark = lastExpectedDozens4.includes(actualDozen) ? '✅' : '❌';
        const currentMarks = resultHistory4Div.innerHTML.replace("ผลการทาย: ", "").replace(/\n/g, "");
        const newMarks = currentMarks + dozenMark;
        resultHistory4Div.innerHTML = "ผลการทาย: " + formatResultHistory(newMarks);
        if (dozenMark === '✅') correctCount4++;
        else incorrectCount4++;
        resultCount4Div.textContent = `ถูก: ${correctCount4} | ผิด: ${incorrectCount4}`;
        lastPrediction4Div.textContent = `ทายครั้งล่าสุด: ${lastPredictionText4} | ออก: ${num} (โหล ${actualDozen || 'ศูนย์'}) - ${dozenMark === '✅' ? 'ถูก' : 'ผิด'}`;
      }

      updatePrediction();
    }

    function updatePrediction() {
      if (history.length === 0) {
        predictionDiv.textContent = "ผลทาย: -";
        prediction2Div.textContent = "ผลทาย: -";
        prediction3Div.textContent = "ผลทาย: -";
        prediction4Div.textContent = "ผลทาย: -";
        recommendationContent.textContent = "กรุณากรอกข้อมูลผลลัพธ์อย่างน้อย 3 ครั้ง";
        updatePercentages();
        return;
      }

      const prediction = predictNext();

      predictionDiv.textContent = "ผลทาย: " + prediction.predictionText;
      prediction2Div.textContent = "ผลทาย: " + prediction.predictionText2;
      prediction3Div.textContent = "ผลทาย: " + prediction.predictionText3;
      prediction4Div.textContent = "ผลทาย: " + prediction.predictionText4;
      recommendationContent.textContent = prediction.recommendation;

      lastPredictionText = prediction.predictionText;
      lastPredictionText2 = prediction.predictionText2;
      lastPredictionText3 = prediction.predictionText3;
      lastPredictionText4 = prediction.predictionText4;

      lastExpectedDozens = prediction.dozens;
      lastExpectedColumns = prediction.columns;
      lastExpectedColumns3 = prediction.columns3;
      lastExpectedDozens4 = prediction.dozens4;
    }

    function addToRoadmap(num) {
      if (currentCol >= 12) {
        alert('โร้ดแม็บเต็มแล้ว');
        return;
      }

      if (history.length > 0) checkPredictions(num);

      roadmapData[currentRow][currentCol] = num;
      history.push({row: currentRow, col: currentCol});
      updateRoadmapUI();
      updatePrediction();

      currentRow++;
      if (currentRow >= 6) {
        currentRow = 0;
        currentCol++;
      }
    }

    function updateRoadmapUI() {
      for (let r = 0; r < 6; r++) {
        for (let c = 0; c < 12; c++) {
          const cell = roadmap.querySelector(`.roadmap-cell[data-row="${r}"][data-col="${c}"]`);
          const val = roadmapData[r][c];
          if (val === null) {
            cell.textContent = '';
            cell.classList.remove('red','black','green');
          } else {
            cell.textContent = val;
            cell.classList.remove('red','black','green');
            if (val === 0) cell.classList.add('green');
            else if (redNumbers.includes(val)) cell.classList.add('red');
            else cell.classList.add('black');
          }
        }
      }
    }

    undoBtn.addEventListener('click', () => {
      if (history.length === 0) return;
      const last = history.pop();
      roadmapData[last.row][last.col] = null;
      currentRow = last.row;
      currentCol = last.col;
      updateRoadmapUI();

      const marks = resultHistoryDiv.innerHTML.replace("ผลการทาย: ", "").replace(/\n/g, "");
      if (marks.length > 0) {
        const newMarks = marks.substring(0, marks.length - 1);
        resultHistoryDiv.innerHTML = "ผลการทาย: " + formatResultHistory(newMarks);
        const lastMark = marks.charAt(marks.length - 1);
        if (lastMark === '✅') correctCount--;
        else if (lastMark === '❌') incorrectCount--;
        resultCountDiv.textContent = `ถูก: ${correctCount} | ผิด: ${incorrectCount}`;
      }

      const marks2 = resultHistory2Div.innerHTML.replace("ผลการทาย: ", "").replace(/\n/g, "");
      if (marks2.length > 0) {
        const newMarks = marks2.substring(0, marks2.length - 1);
        resultHistory2Div.innerHTML = "ผลการทาย: " + formatResultHistory(newMarks);
        const lastMark = marks2.charAt(marks2.length - 1);
        if (lastMark === '✅') correctCount2--;
        else if (lastMark === '❌') incorrectCount2--;
        resultCount2Div.textContent = `ถูก: ${correctCount2} | ผิด: ${incorrectCount2}`;
      }

      updatePrediction();
    });

    clearBtn.addEventListener('click', () => {
      for (let r = 0; r < 6; r++) {
        for (let c = 0; c < 12; c++) {
          roadmapData[r][c] = null;
        }
      }
      history.length = 0;
      currentRow = 0;
      currentCol = 0;
      updateRoadmapUI();

      predictionDiv.textContent = "ผลทาย: -";
      prediction2Div.textContent = "ผลทาย: -";
      prediction3Div.textContent = "ผลทาย: -";
      prediction4Div.textContent = "ผลทาย: -";

      resultHistoryDiv.innerHTML = "ผลการทาย: ";
      resultHistory2Div.innerHTML = "ผลการทาย: ";
      resultHistory3Div.innerHTML = "ผลการทาย: ";
      resultHistory4Div.innerHTML = "ผลการทาย: ";

      resultCountDiv.textContent = "";
      resultCount2Div.textContent = "";
      resultCount3Div.textContent = "";
      resultCount4Div.textContent = "";

      numInfoDozen.textContent = "";
      numInfoColumn.textContent = "";
      numInfoColumn3.textContent = "";
      numInfoDozen4.textContent = "";

      lastExpectedDozens = [];
      lastExpectedColumns = [];
      lastExpectedColumns3 = [];
      lastExpectedDozens4 = [];

      correctCount = 0;
      incorrectCount = 0;
      correctCount2 = 0;
      incorrectCount2 = 0;
      correctCount3 = 0;
      incorrectCount3 = 0;
      correctCount4 = 0;
      incorrectCount4 = 0;

      updatePercentages();
    });

    // สร้างตารางรูเล็ต
    numbers.forEach((num, index) => {
      const cell = document.createElement('div');
      cell.className = `number-cell ${redNumbers.includes(num) ? 'red' : 'black'}`;
      cell.textContent = num;
      const col = (index % 12) + 1;
      const row = Math.floor(index / 12) + 1;
      cell.style.gridColumn = col;
      cell.style.gridRow = row;
      cell.addEventListener('click', () => addToRoadmap(num));
      table.appendChild(cell);
    });
  </script>
</body>
<script>
    // ... โค้ด JavaScript ของรูเล็ตเดิมทั้งหมดของนาย ...
</script>

<script>
  const start = Date.now();
  const limit = 5 * 60 * 1000; // 5 นาที

  const interval = setInterval(() => {
    if (Date.now() - start > limit) {
      clearInterval(interval);
      document.body.innerHTML = `
        <div style="color:white;font-size:24px;text-align:center;margin-top:20%;">
          ลิงก์นี้หมดอายุแล้ว
        </div>`;
    }
  }, 1000);
</script>

</body>
</html>